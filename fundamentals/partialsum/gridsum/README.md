# Problem

이차원 배열 `A[][]`에서 `(y1, x1, y2, x2)`에 속하는 영역의 합을 구하는 문제이다. 여기서 `y1 < y2` 및 `x1 < x2` 조건이 성립한다.

# Idea

이 문제를 효율적으로 해결하기 위해, `gsum[][]`이라는 배열을 만들어 각 항목 `gsum[y][x]`이 `(0,0)`에서 `(y,x)`까지의 부분 배열 합을 나타내도록 하자. 이렇게 하면 원하는 영역의 합을 빠르게 계산할 수 있다.

예를 들어, 다음과 같은 `matrix[][]`가 주어졌을 때, 대응하는 `gsum[][]`은 다음과 같다.

```c
matrix:
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1

gsum:
1 2  3  4  5
2 4  6  8  12
3 6  9  12 16
4 8  12 16 20
5 12 15 20 25
``` 

이제 `gsum[2][2]`를 구하는 과정을 살펴보자. 이때 `gsum[1][1]`이 두 번 겹치기 때문에 한 번 빼줘야 한다.

```c
gsum:
1 2  3  4  5
2 4  6  8  12
3 6  ?  ?  ? 
? ?  ?  ?  ?
? ?  ?  ?  ?

gsum[2][2] = matrix[2][2] + gsum[1][2] + gsum[2][1] - gsum[1][1];
```

따라서 임의의 `(y, x)`에서 `gsum[y][x]`를 구하는 일반적인 공식은 다음과 같다.

```c
if (y > 0)
  gsum[y][x] += gsum[y-1][x];
if (x > 0)
  gsum[y][x] += gsum[y][x-1];
if (y > 0 && x > 0)
  gsum[y][x] -= gsum[y-1][x-1];
```

이제 `(y1, x1, y2, x2)`로 정의된 영역의 합을 구해보자. `gsum[y1][x1]`을 `a`, `gsum[y2][x2]`을 `b`라고 할 때, 겹치는 부분을 조정하여 영역 합을 계산할 수 있다. `gsum[y1 - 1][x1 - 1]` 가 두번 제거되었으므로 한번 더해 준다.

```c
 y1 x1 y2 x2
[ 1, 1, 3, 3]

# % % % %
$ a 0 0 0
$ 0 0 0 0
$ 0 0 b 0
0 0 0 0 0

area sum = gsum[y2][x2] -          :{b}
           gsum[y1 - 1][x2] -      :{#,%}
           gsum[y2][x1 - 1] +      :{#,$}
           gsum[y1 - 1][x1 - 1]    :{#}
```

이 방법을 사용하면 `gsum[][]`를 미리 계산해둔 후, 각 부분 영역의 합을 상수 시간 내에 구할 수 있다.

# Implementation

* [c++11](a.cpp)

# Complexities

```
O(N) O(N)
```

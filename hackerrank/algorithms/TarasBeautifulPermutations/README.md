# Problem

[Tara's beautiful permutations](https://www.hackerrank.com/challenges/taras-beautiful-permutations/problem)

# Idea

숫자의 종류는 문제가 되지 않는다. 예를 들어서 `{1,1,2}`의 답과
`{2,2,4}`의 답은 같다. 그렇다면 무엇 때문에 두 경우의 답이 같을까?
한번 등장하는 숫자의 수를 i라 하고 두번 등장하는 숫자의 수를 j라 하면
앞서 언급한 두 숫자들은 `i,j = 1,2` 로 같기 때문에 서로의 답이 같다.

따라서 숫자의 종류보다는 i,j를 기준으로 경우의 수를 만들어 문제를
해결해야 한다.

다음과 같은 예를 조금 더 생각해 보자. A가 `{1,1,2,2,3,4}` 일때
`i,j = 2,2`이다. A에서 숫자가 하나 빠진 경우를 A'라고 하자.  A'에서
숫자 하나를 더해서 A가 되는 모든 경우의 수 들을 생각해보자.  이것 에서
규칙을 발견 할 수 있다면 부분 문제를 정의하여 재귀적으로 문제를 해결 할 수 있다.

첫번째는 i가 하나 감소한 경우이다. 예를 들어서 `{1,1,2,2,3}`는 `i,j = 1,2` 이다. 
만약 `4`가 추가 된다면 A가 될 수 있다. `{1,1,2,2,4}`는 `i,j = 1,2` 이다. 
만약 `3`이 추가 된다면 역시 A가 될 수 있다. 그외의 경우는 생각 할 수 없다.
두번째는 j가 하나 감소하고 i가 하나 증가한 경우이다. 예를 들어서
`{1,1,2,3,4}`는 `i,j = 3,1` 이다. 만약 `2`가 추가 된다면 A가 될 수 있다.
`{1,2,2,3,4}`는 `i,j = 3,1` 이다. 만약 `1`이 추가 된다면 A가 될 수 있다.

이제 `{1,1,2,2,3,4}`의 답을 `S({1,1,2,2,3,4})`라고 정의하면 
다음과 같은 전개식을 만들어 낼 수 있다.

```
S({1,1,2,2,3,4} = S({1,1,2,2,3} + S({1,1,2,2,4}) + 
                  S({1,2,2,3,4} + S({1,1,2,3,4})
S({1,2,2,3,4})  = S({1,2,2,3}) + S({1,2,2,4}) + // S({2,2,3,4})는 불가능하다.
                  S({1,2,3,4}) 
```

이때 주의해야 할 것이 있다. 위의 전개식에서 `S({1,2,2,3,4})`를 살펴보자.
`S({2,2,3,4})`는 전개식에서 제거 되어 있다. 숫자 `1`은 `S({1,2,2,3,4})`에서
반드시 추가되어야 `S({1,1,2,2,3,4})`가 될 수 있기 때문에 
숫자 `1은` 경우의 수에서 제거 되야 한다.

여기서 부분문제 S는 i가 하나 감소되어 만들어진 것과 j가 하나 감소되어
만들어진 것이 성격이 다르다는 것을 발견 할 수 있다. 두가지 성격을 각각
0, 1로 표기하고 k라고 이름 짓자.

앞서 언급한 전개식을 `i,j,k`의 표현으로 바꾸어 보자.

```
S(2,2,0) = S(1,2,0) + S(1,2,0) + 
           S(3,1,1) + S(3,1,1)
         = S(1,2,0) * 2 + S(3,1,1) * 2
S(3,1,1) = S(2,1,0) + S(2,1,0) + 
           S(4,0,1)
         = S(2,1,0) * 2 + S(4,0,1) * 1
```

부분 문제 `S(i,j,k)`의 의미가 조금 더 명확해 졌다.  즉 S는 한번
등장하는 숫자 i와 두번 등장하는 숫자 j 그리고 S가 이전 S에서 i 를
감소했는지 혹은 j를 감소했는지 여부가 주어졌을때 beautiful
permutations를 제작할 수 있는 경우의 수를 의미한다.

이번에는 수식으로 정리해보자. 

```
S(i, j, 0) = S(i - 1, j, 0) * i       + S(i + 1, j - 1, 1) * j
S(i, j, 1) = S(i - 1, j, 0) * (i - 1) + S(i + 1, j - 1, 1) * j
```

마지막으로 `S({1,1,2})`를 해결하기 위해
`i,j,k`를 이용하여 전개해 보자.

```
1 1 0
_0 1 0
__-1 1 0 : 0
__1 0 1
___0 0 0 : 1
___2 -1 1 : 0
__: 0
_: 0
_2 0 1
__1 0 0
___0 0 0 : 1
___2 -1 1 : 0
__: 1
__3 -1 1 : 0
_: 1
: 1
1
```

따라서 다음과 같은 베이스 컨디션이 필요하다.

```
S(0, 0, 0) = 1
S(0, 0, 1) = 0
S(-1,?, ?) = 0
S(?,-1, ?) = 0
```

# Implementation

[c++11](a.cpp)

# Time Complexity

O(2^N)
